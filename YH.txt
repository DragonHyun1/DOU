================================================================================
ğŸ”¬ Terminal Configuration & Voltage Range Test for ai3 Channel
================================================================================

ğŸ“Œ Manual Configuration (from NI Trace):
   â†’ Terminal Config: -1 (RSE)
   â†’ Voltage Range: Â±5V
   â†’ Sample Rate: 30,000 Hz
   â†’ Sample Mode: Continuous
   â†’ Samples Per Chan: 1,000

ğŸ“Œ Manual Measurement Result:
   â†’ ai3 Voltage: 1.05V (Rail voltage)
   â†’ ai3 Current: 1.018 mA

ğŸ“Œ DoU Current Configuration:
   â†’ Terminal Config: DEFAULT
   â†’ Voltage Range: Â±5V
   â†’ Measured Voltage: 0.033mV (Shunt drop)
   â†’ Calculated Current: 6.533 mA (6.42x higher)

ğŸ” Test Objectives:
   1. Voltage Range: Test Â±5V vs Â±10V
   2. Current Calculation: Test Average vs Cumulative

================================================================================

âš ï¸  Note: Using direct constant 10106 for DIFFERENTIAL mode

================================================================================
ğŸ§ª Testing: RSE + Â±5V
================================================================================
Creating channel: Dev1/ai3
  â†’ Terminal Config: RSE
  â†’ Voltage Range: Â±5V (-5.0V to 5.0V)

ğŸ“Š Reading 1000 samples at 30000.0 Hz...
âœ… Read 1000 samples

ğŸ“Š Voltage Results (RSE + Â±5V):
   â†’ Average: 1.013136 V (1013.136 mV)
   â†’ Max: 1.033908 V (1033.908 mV)
   â†’ Min: 0.999383 V (999.383 mV)

ğŸ“Š Current Calculation Method 1: AVERAGE (í‰ê·  ì „ë¥˜)
   â†’ Method: (Avg_Voltage / Shunt_R) Ã— 1000
   â†’ Average Current: 202627.163 mA
   â†’ Max Current: 206781.593 mA
   â†’ Min Current: 199876.621 mA

ğŸ“Š Current Calculation Method 2: CUMULATIVE (ëˆ„ì  ì „ë¥˜)
   â†’ Method: Sum(Each_Sample / Shunt_R) / Num_Samples
   â†’ Cumulative Sum: 202627162.790 mAÂ·samples
   â†’ Average from Cumulative: 202627.163 mA
   â†’ Difference: 0.000000 mA

   âœ… Both methods give same result (as expected)

ğŸ“ˆ Comparison with Manual:
   â†’ Voltage: 1.013136 V vs 1.05 V (Manual)
   â†’ Voltage Ratio: 0.964891x

   â†’ Current (Method 1): 202627.163 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 199044.364x

   â†’ Current (Method 2): 202627.163 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 199044.364x

   ğŸ” Measurement Type: Rail Voltage
   â†’ This measures the power rail voltage (like Manual!)

   âœ… VOLTAGE MATCHES MANUAL! (RSE + Â±5V is correct)
   âœ— Current mismatch (ratio: 199044.364x)

================================================================================
ğŸ§ª Testing: RSE + Â±10V
================================================================================
Creating channel: Dev1/ai3
  â†’ Terminal Config: RSE
  â†’ Voltage Range: Â±10V (-10.0V to 10.0V)

ğŸ“Š Reading 1000 samples at 30000.0 Hz...
âœ… Read 1000 samples

ğŸ“Š Voltage Results (RSE + Â±10V):
   â†’ Average: 1.013359 V (1013.359 mV)
   â†’ Max: 1.032442 V (1032.442 mV)
   â†’ Min: 0.999284 V (999.284 mV)

ğŸ“Š Current Calculation Method 1: AVERAGE (í‰ê·  ì „ë¥˜)
   â†’ Method: (Avg_Voltage / Shunt_R) Ã— 1000
   â†’ Average Current: 202671.776 mA
   â†’ Max Current: 206488.477 mA
   â†’ Min Current: 199856.894 mA

ğŸ“Š Current Calculation Method 2: CUMULATIVE (ëˆ„ì  ì „ë¥˜)
   â†’ Method: Sum(Each_Sample / Shunt_R) / Num_Samples
   â†’ Cumulative Sum: 202671776.432 mAÂ·samples
   â†’ Average from Cumulative: 202671.776 mA
   â†’ Difference: 0.000000 mA

   âœ… Both methods give same result (as expected)

ğŸ“ˆ Comparison with Manual:
   â†’ Voltage: 1.013359 V vs 1.05 V (Manual)
   â†’ Voltage Ratio: 0.965104x

   â†’ Current (Method 1): 202671.776 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 199088.189x

   â†’ Current (Method 2): 202671.776 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 199088.189x

   ğŸ” Measurement Type: Rail Voltage
   â†’ This measures the power rail voltage (like Manual!)

   âœ… VOLTAGE MATCHES MANUAL! (RSE + Â±10V is correct)
   âœ— Current mismatch (ratio: 199088.189x)

================================================================================
ğŸ§ª Testing: NRSE + Â±5V
================================================================================
Creating channel: Dev1/ai3
  â†’ Terminal Config: NRSE
  â†’ Voltage Range: Â±5V (-5.0V to 5.0V)

ğŸ“Š Reading 1000 samples at 30000.0 Hz...
âœ… Read 1000 samples

ğŸ“Š Voltage Results (NRSE + Â±5V):
   â†’ Average: 1.031419 V (1031.419 mV)
   â†’ Max: 1.036231 V (1036.231 mV)
   â†’ Min: 1.027339 V (1027.339 mV)

ğŸ“Š Current Calculation Method 1: AVERAGE (í‰ê·  ì „ë¥˜)
   â†’ Method: (Avg_Voltage / Shunt_R) Ã— 1000
   â†’ Average Current: 206283.762 mA
   â†’ Max Current: 207246.196 mA
   â†’ Min Current: 205467.886 mA

ğŸ“Š Current Calculation Method 2: CUMULATIVE (ëˆ„ì  ì „ë¥˜)
   â†’ Method: Sum(Each_Sample / Shunt_R) / Num_Samples
   â†’ Cumulative Sum: 206283761.855 mAÂ·samples
   â†’ Average from Cumulative: 206283.762 mA
   â†’ Difference: 0.000000 mA

   âœ… Both methods give same result (as expected)

ğŸ“ˆ Comparison with Manual:
   â†’ Voltage: 1.031419 V vs 1.05 V (Manual)
   â†’ Voltage Ratio: 0.982304x

   â†’ Current (Method 1): 206283.762 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 202636.308x

   â†’ Current (Method 2): 206283.762 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 202636.308x

   ğŸ” Measurement Type: Rail Voltage
   â†’ This measures the power rail voltage (like Manual!)

   âœ… VOLTAGE MATCHES MANUAL! (NRSE + Â±5V is correct)
   âœ— Current mismatch (ratio: 202636.308x)

================================================================================
ğŸ§ª Testing: NRSE + Â±10V
================================================================================
Creating channel: Dev1/ai3
  â†’ Terminal Config: NRSE
  â†’ Voltage Range: Â±10V (-10.0V to 10.0V)

ğŸ“Š Reading 1000 samples at 30000.0 Hz...
âœ… Read 1000 samples

ğŸ“Š Voltage Results (NRSE + Â±10V):
   â†’ Average: 1.031420 V (1031.420 mV)
   â†’ Max: 1.037648 V (1037.648 mV)
   â†’ Min: 1.027236 V (1027.236 mV)

ğŸ“Š Current Calculation Method 1: AVERAGE (í‰ê·  ì „ë¥˜)
   â†’ Method: (Avg_Voltage / Shunt_R) Ã— 1000
   â†’ Average Current: 206283.923 mA
   â†’ Max Current: 207529.667 mA
   â†’ Min Current: 205447.286 mA

ğŸ“Š Current Calculation Method 2: CUMULATIVE (ëˆ„ì  ì „ë¥˜)
   â†’ Method: Sum(Each_Sample / Shunt_R) / Num_Samples
   â†’ Cumulative Sum: 206283922.917 mAÂ·samples
   â†’ Average from Cumulative: 206283.923 mA
   â†’ Difference: 0.000000 mA

   âœ… Both methods give same result (as expected)

ğŸ“ˆ Comparison with Manual:
   â†’ Voltage: 1.031420 V vs 1.05 V (Manual)
   â†’ Voltage Ratio: 0.982304x

   â†’ Current (Method 1): 206283.923 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 202636.467x

   â†’ Current (Method 2): 206283.923 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 202636.467x

   ğŸ” Measurement Type: Rail Voltage
   â†’ This measures the power rail voltage (like Manual!)

   âœ… VOLTAGE MATCHES MANUAL! (NRSE + Â±10V is correct)
   âœ— Current mismatch (ratio: 202636.467x)

================================================================================
ğŸ§ª Testing: DIFFERENTIAL + Â±5V
================================================================================
Creating channel: Dev1/ai3
  â†’ Terminal Config: DIFFERENTIAL
  â†’ Voltage Range: Â±5V (-5.0V to 5.0V)

   âŒ DIFFERENTIAL + Â±5V failed: 'int' object has no attribute 'value'

================================================================================
ğŸ§ª Testing: DIFFERENTIAL + Â±10V
================================================================================
Creating channel: Dev1/ai3
  â†’ Terminal Config: DIFFERENTIAL
  â†’ Voltage Range: Â±10V (-10.0V to 10.0V)

   âŒ DIFFERENTIAL + Â±10V failed: 'int' object has no attribute 'value'

================================================================================
ğŸ§ª Testing: DEFAULT + Â±5V
================================================================================
Creating channel: Dev1/ai3
  â†’ Terminal Config: DEFAULT
  â†’ Voltage Range: Â±5V (-5.0V to 5.0V)

ğŸ“Š Reading 1000 samples at 30000.0 Hz...
âœ… Read 1000 samples

ğŸ“Š Voltage Results (DEFAULT + Â±5V):
   â†’ Average: 0.000008 V (0.008 mV)
   â†’ Max: 0.000486 V (0.486 mV)
   â†’ Min: -0.000114 V (-0.114 mV)

ğŸ“Š Current Calculation Method 1: AVERAGE (í‰ê·  ì „ë¥˜)
   â†’ Method: (Avg_Voltage / Shunt_R) Ã— 1000
   â†’ Average Current: 1.675 mA
   â†’ Max Current: 97.287 mA
   â†’ Min Current: -22.869 mA

ğŸ“Š Current Calculation Method 2: CUMULATIVE (ëˆ„ì  ì „ë¥˜)
   â†’ Method: Sum(Each_Sample / Shunt_R) / Num_Samples
   â†’ Cumulative Sum: 1674.835 mAÂ·samples
   â†’ Average from Cumulative: 1.675 mA
   â†’ Difference: 0.000000 mA

   âœ… Both methods give same result (as expected)

ğŸ“ˆ Comparison with Manual:
   â†’ Voltage: 0.000008 V vs 1.05 V (Manual)
   â†’ Voltage Ratio: 0.000008x

   â†’ Current (Method 1): 1.675 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 1.645x

   â†’ Current (Method 2): 1.675 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 1.645x

   ğŸ” Measurement Type: Near Zero

   âœ— Current mismatch (ratio: 1.645x)

================================================================================
ğŸ§ª Testing: DEFAULT + Â±10V
================================================================================
Creating channel: Dev1/ai3
  â†’ Terminal Config: DEFAULT
  â†’ Voltage Range: Â±10V (-10.0V to 10.0V)

ğŸ“Š Reading 1000 samples at 30000.0 Hz...
âœ… Read 1000 samples

ğŸ“Š Voltage Results (DEFAULT + Â±10V):
   â†’ Average: -0.000013 V (-0.013 mV)
   â†’ Max: 0.001183 V (1.183 mV)
   â†’ Min: -0.000258 V (-0.258 mV)

ğŸ“Š Current Calculation Method 1: AVERAGE (í‰ê·  ì „ë¥˜)
   â†’ Method: (Avg_Voltage / Shunt_R) Ã— 1000
   â†’ Average Current: -2.578 mA
   â†’ Max Current: 236.655 mA
   â†’ Min Current: -51.675 mA

ğŸ“Š Current Calculation Method 2: CUMULATIVE (ëˆ„ì  ì „ë¥˜)
   â†’ Method: Sum(Each_Sample / Shunt_R) / Num_Samples
   â†’ Cumulative Sum: -2578.453 mAÂ·samples
   â†’ Average from Cumulative: -2.578 mA
   â†’ Difference: 0.000000 mA

   âœ… Both methods give same result (as expected)

ğŸ“ˆ Comparison with Manual:
   â†’ Voltage: 0.000013 V vs 1.05 V (Manual)
   â†’ Voltage Ratio: 0.000012x

   â†’ Current (Method 1): 2.578 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 2.533x

   â†’ Current (Method 2): 2.578 mA vs 1.018 mA (Manual)
   â†’ Current Ratio: 2.533x

   ğŸ” Measurement Type: Shunt Drop
   â†’ This measures voltage drop across shunt

   âœ— Current mismatch (ratio: 2.533x)

================================================================================
ğŸ“‹ SUMMARY - Terminal Configuration & Voltage Range Comparison
================================================================================

Config       Range    Voltage      Current      Type            Match
-------------------------------------------------------------------------------------
RSE          Â±5V        1013.136mV 202627.163mA Rail Voltage
RSE          Â±10V       1013.359mV 202671.776mA Rail Voltage
NRSE         Â±5V        1031.419mV 206283.762mA Rail Voltage
NRSE         Â±10V       1031.420mV 206283.923mA Rail Voltage
DEFAULT      Â±5V           0.008mV      1.675mA Near Zero
DEFAULT      Â±10V          0.013mV      2.578mA Shunt Drop

=====================================================================================
ğŸ¯ RECOMMENDED CONFIGURATION:
   â†’ Terminal Config: DEFAULT
   â†’ Voltage Range: Â±5V
   â†’ Measured Voltage: 0.008 mV
   â†’ Calculated Current: 1.675 mA
   â†’ Current Ratio: 1.645x (vs Manual)
   â†’ Measurement Type: Near Zero

ğŸ“ Note on Current Calculation:
   â†’ Method 1 (Average): (Avg_Voltage / R) - í˜„ì¬ DoU ë°©ì‹
   â†’ Method 2 (Cumulative): Sum(V[i]/R) / N - ë™ì¼í•œ ê²°ê³¼
   â†’ Both methods are mathematically equivalent
=====================================================================================

âœ… Test completed
